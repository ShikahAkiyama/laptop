<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Katalog Laptop Ready Stock</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; font-family: 'Inter', sans-serif; }
        .hero-section { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 60px 0; margin-bottom: 40px; border-bottom: 5px solid #ffc107; }
        .brand-header { background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 25px; border-left: 5px solid #0d6efd; }
        .table-container { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 50px; }
        .table thead { background-color: #0d6efd; color: white; }
        .price-text { font-weight: bold; color: #d63031; white-space: nowrap; }
        .stock-tag { font-size: 0.8rem; font-weight: 600; }
        .card { transition: all 0.3s; border: none; border-radius: 12px; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .spec-label { font-size: 0.8rem; color: #636e72; margin-bottom: 0; }
        .wa-button { position: fixed; bottom: 20px; right: 20px; z-index: 1000; background: #25d366; color: white; border-radius: 50px; padding: 10px 20px; text-decoration: none; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .price-text:hover { background-color: #fff3cd; cursor: text; border-radius: 4px; }
        th { cursor: pointer; }
    </style>
</head>
<body>

<header class="hero-section text-center">
    <div class="container">
        <h1 class="display-5 fw-bold">PROMO LAPTOP SECOND READY STOCK</h1>
        <p class="lead">Kondisi Terjamin â€¢ SSD Anti Lemot â€¢ Siap Pakai</p>
    </div>
</header>

<div class="container">

    <div class="brand-header">
        <h2 class="mb-0">âœ… LENOVO THINKPAD SERIES</h2>
    </div>
    <div class="table-container text-nowrap table-responsive">
        <table class="table table-hover align-middle mb-0" id="laptopTable">
            <thead>
                <tr>
                    <th>Model Laptop</th>
                    <th>Processor</th>
                    <th>RAM/SSD</th>
                    <th>Layar & Fitur</th>
                    <th>Harga</th>
                    <th>Stok</th>
                </tr>
            </thead>
            <tbody id="lenovoTableBody">
                <!-- Data Lenovo akan masuk di sini via JS -->
            </tbody>
        </table>
    </div>

    <div class="brand-header mt-5" style="border-left-color: #0076d6;">
        <h2 class="mb-0">âœ… LAPTOP DELL LATITUDE</h2>
    </div>
    <div class="row g-4 mb-5" id="dellContainer">
        <!-- Data Dell akan masuk di sini via JS -->
    </div>

    <div class="brand-header mt-5" style="border-left-color: #000;">
        <h2 class="mb-0">âœ… LAPTOP HP (PROBOOK & ELITEBOOK)</h2>
    </div>
    <div class="row g-4 mb-5" id="hpContainer">
        <!-- Data HP akan masuk di sini via JS -->
    </div>
</div>

<footer class="bg-dark text-white text-center py-4 mt-5">
    <p class="mb-0">Hubungi Kami untuk Pemesanan & Detail Lebih Lanjut</p>
    <small>Stok dapat berubah sewaktu-waktu</small>
</footer>

<a href="https://wa.me/628994335111" class="wa-button">
    ðŸ’¬ Chat WhatsApp
</a>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
</script>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCvwo1qhS9ugnweRccAP0Wgvk1MQ2XBdXg",
        authDomain: "laptop-e718c.firebaseapp.com",
        projectId: "laptop-e718c",
        storageBucket: "laptop-e718c.firebasestorage.app",
        messagingSenderId: "21040544479",
        appId: "1:21040544479:web:67549dc570d07f3544076a",
        measurementId: "G-SP2R77RD68"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Fungsi Format Rupiah
    const formatRupiah = (num) => {
        return "Rp " + num.toLocaleString('id-ID');
    };

    // Fungsi Render Baris Tabel (Khusus Lenovo)
    const renderTableRow = (data) => {
        const stockBadge = data.stock < 5 ? 'bg-danger' : 'bg-primary';
        return `
            <tr>
                <td><b>${data.model}</b></td>
                <td>${data.processor}</td>
                <td>${data.ram} / ${data.storage}</td>
                <td>${data.features}</td>
                <td class="price-text">${formatRupiah(data.price)}</td>
                <td><span class="badge ${stockBadge} stock-tag">${data.stock} Unit</span></td>
            </tr>
        `;
    };

    // Fungsi Render Card (Khusus Dell & HP)
    const renderCard = (data) => {
        const stockBadge = data.stock < 5 ? 'bg-danger' : 'bg-primary';
        return `
            <div class="col-md-4">
                <div class="card h-100 p-3">
                    <h5>${data.model}</h5>
                    <p class="spec-label">${data.processor} | ${data.ram} | ${data.storage}</p>
                    <p class="small">${data.features}</p>
                    <div class="mt-auto d-flex justify-content-between align-items-center">
                        <span class="price-text">${formatRupiah(data.price)}</span>
                        <span class="badge ${stockBadge}">${data.stock} Unit</span>
                    </div>
                </div>
            </div>
        `;
    };

    // Load Data dari Firebase
    async function loadLaptops() {
        const lenovoContainer = document.getElementById('lenovoTableBody');
        const dellContainer = document.getElementById('dellContainer');
        const hpContainer = document.getElementById('hpContainer');

        // Bersihkan container
        lenovoContainer.innerHTML = '<tr><td colspan="6" class="text-center">Memuat data...</td></tr>';
        dellContainer.innerHTML = '';
        hpContainer.innerHTML = '';

        const q = query(collection(db, "laptops"), orderBy("price", "asc"));
        const querySnapshot = await getDocs(q);

        lenovoContainer.innerHTML = ''; // Hapus loading

        querySnapshot.forEach((doc) => {
            const data = doc.data();
            const brand = data.brand.toLowerCase();
            
            // Cek Status: Jika 'inactive', jangan ditampilkan. 
            // (Data lama tanpa field status dianggap active)
            if (data.status === 'inactive') return;

            if (brand.includes('lenovo')) {
                lenovoContainer.innerHTML += renderTableRow(data);
            } else if (brand.includes('dell')) {
                dellContainer.innerHTML += renderCard(data);
            } else if (brand.includes('hp')) {
                hpContainer.innerHTML += renderCard(data);
            }
        });
    }

    // Jalankan saat halaman dimuat
    loadLaptops();
</script>
</body>
</html>